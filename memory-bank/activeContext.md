# Grimheim Combat Simulator Active Context

## Current Focus
1. Combat System Implementation
   - Ranged combat mechanics
   - Special rule interactions
   - Combat resolution flow
   - Dice management

2. Bug Fixes and Improvements
   - Ravaging rule implementation
   - Critical hit blocking
   - Layout adjustments
   - Type definitions

## Recent Changes
1. Combat Rules
   - Fixed Ravaging rule to require critical hits
   - Improved critical hit blocking logic
   - Enhanced combat log clarity
   - Updated weapon rule processing

2. UI Improvements
   - Adjusted layout for better visibility
   - Enhanced model card display
   - Improved combat log readability
   - Fixed container overflow issues

3. Code Quality
   - Updated type definitions
   - Improved error handling
   - Enhanced code documentation
   - Fixed linter issues

## Active Decisions
1. Combat Implementation
   - Separate combat screens for ranged and melee
   - Phase-based combat resolution
   - Clear rule application feedback
   - Detailed combat logging

2. UI/UX Choices
   - Retro-style interface
   - Clear phase indicators
   - Interactive dice selection
   - Informative tooltips

3. Technical Decisions
   - React with TypeScript
   - Styled-components for styling
   - Component-based architecture
   - Strong type safety

## Next Steps
1. Short Term
   - Implement remaining special rules
   - Add more test models
   - Enhance error handling
   - Improve performance

2. Medium Term
   - Add melee combat system
   - Implement more factions
   - Enhance UI feedback
   - Add animation effects

3. Long Term
   - Full army builder
   - Campaign system
   - Battle scenarios
   - Statistics tracking

## Current Issues
1. Known Bugs
   - Some special rule interactions
   - Edge cases in combat resolution
   - Type definition conflicts
   - Layout issues in specific cases

2. Technical Debt
   - Code duplication in combat logic
   - Complex state management
   - Incomplete type coverage
   - Missing test coverage

3. Performance Concerns
   - Component re-rendering
   - State update efficiency
   - Animation performance
   - Load time optimization

## Development Status
1. Implemented Features
   - Basic combat system
   - Model selection
   - Weapon management
   - Combat resolution
   - Special rules

2. In Progress
   - Advanced rule interactions
   - UI improvements
   - Performance optimization
   - Bug fixes

3. Planned Features
   - Additional factions
   - More weapon types
   - Enhanced combat options
   - Advanced statistics 